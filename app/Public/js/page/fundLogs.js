/**  * kuaihuojian project - kuaihuojian project  */ "use strict";function invoiceWordmethod(e,i){for(var t="",n="",o=-1,a=0,c=e.length;a<c;a++)o=e[a].id,n=e[a].name,o==i?selected=' selected="selected" ':selected="",t+="<option "+selected+' value="'+o+'">'+n+"</option>";return t}var region=null,clickObj=null,invoiceWord={parent:[{id:0,name:"发票类型",child:[{id:0,name:"选择科目"}]},{id:1,name:"普通发票",child:[{id:1,name:"服务费"},{id:2,name:"技术服务费"},{id:3,name:"广告服务费"},{id:4,name:"咨询服务费"}]},{id:2,name:"专用发票",child:[{id:5,name:"专业技术服务"},{id:6,name:"软件服务"},{id:7,name:"咨询服务"},{id:8,name:"广告服务"},{id:9,name:"信息系统服务"}]}]};$("#toInvoiceDialog").dialog({width:660,title:"提交发票信息",buttons:[{text:"取消",click:function(){$(this).dialog("close")}},{text:"提交",click:function(){$("#toInvoiceForm").submit()}}]}),$("#toInvoiceForm").validate({submitHandler:function(e){var i="",t=$("#toInvoiceForm").find("input[name='invoiceid']").val(),n=$("select[name='invoice_type']").find("option:selected").val(),o=$("select[name='type']").find("option:selected").val(),a=$("select[name='province']").find("option:selected").val(),c=$("select[name='city']").find("option:selected").val();return"0"==n?void alert("请选择发票类型"):"0"==o?void alert("请选择科目"):a==-1?void alert("请选择省市区"):c==-1?void alert("请选择城市"):(i=""==t?"/Invoice/saveInvoiceDo.html":"/Invoice/doSaveInvoice.html",void ajaxData.post({url:i,data:$("#toInvoiceForm").serialize(),success:function(e){1==e.code?promptDialog(e.message,{ok:function(){window.location.reload()}}):e.code==-1?alert(e.message):alert("服务器忙")},error:function(){alert("修改失败")}}))}}),$(".toInvoice").click(function(){var e=$(this),i=e.attr("tradeid"),t=e.attr("price");$("#fund_change").text(t+"元"),$('input[name="companyname"]').val(""),$('input[name="consignee"]').val(""),$('input[name="mobile"]').val(""),$('input[name="detail"]').val(""),$('input[name="postcode"]').val(""),$('input[name="companyname"]').val(""),$("input[name='invoiceid']").val(""),$("input[name='tradeid']").val(i),$("#toInvoiceDialog").dialog("open"),$("#fund_change").text(t+"元"),$("#invoiceRemark").parent().hide(),$("#invoiceSelect1").html(invoiceWordmethod(invoiceWord.parent,0)),$("#invoiceSelect2").html(invoiceWordmethod(invoiceWord.parent[0].child,0)),invoiceSelect1.render(),invoiceSelect2.render(),$("#province").qdSelectCity({province:"-1",city:"-1"}),province.render(),citys.render()}),$(".moidfyInvoice").click(function(){var e=$(this),i=e.attr("tradeid");$("#toInvoiceForm").find("input[name='tradeid']").val(i),$("#toInvoiceDialog").dialog("open"),ajaxData.post({url:"/Invoice/ajax_get_invoiceinfo",data:{tradeid:i},success:function(e){if(e.status){var i=e.data,t=i.id,n=i.fund_change,o=i.title,a=i.invoice_type||0,c=i.type||0,d=i.consignee,l=i.mobile,r=i.detail,v=i.postcode,s=i.province,m=i.city,p=i.remark;$("#fund_change").text(n+"元"),$('input[name="companyname"]').val(o),$('input[name="consignee"]').val(d),$('input[name="mobile"]').val(l),$('input[name="detail"]').val(r),$('input[name="postcode"]').val(v),$('input[name="companyname"]').val(o),$("input[name='invoiceid']").val(t),$("#invoiceRemark").text(p).parent().show(),$("#invoiceSelect1").html(invoiceWordmethod(invoiceWord.parent,a)),$("#invoiceSelect2").html(invoiceWordmethod(invoiceWord.parent[a].child,c)),invoiceSelect1.render(),invoiceSelect2.render(),$("#province").qdSelectCity({province:s,city:m}),province.render(),citys.render()}else alert(e.msg)}})}),$("#viewInvoiceDialog").dialog({width:660,title:"查看发票"}),$(".viewInvoice").click(function(){var e=$(this),i=e.attr("tradeid");ajaxData.post({url:invoiceUrl,data:{tradeid:i},success:function(e){1==e.code?($("#viewInvoiceDialog").html(e.html),$("#viewInvoiceDialog").dialog("open")):e.code==-1?alert(e.message):alert("服务器忙")},error:function(){alert("服务器忙")}})}),$("#pushPriceTotalDialog").dialog({width:780,title:"本次推送费用总计",buttons:[{text:"确定",click:function(){$(this).dialog("close")}}]}),$(".pushPriceTotal").click(function(){var e=$(this),i=e.attr("tradeid");$.ajax({type:"post",url:detailUrl,data:{tradeid:i},dataType:"json",error:function(){alert("服务器忙")},success:function(e){1==e.code?($(".push1").html(e.base),$(".push2").html(e.extend),$("#pushPriceTotalDialog").dialog("open")):e.code==-1?alert(e.message):alert("服务器忙")}})}),$(function(){$("#reacordState").selectUI({width:200,height:30,addClass:"fl",after:function(e){window.location.href=$(e).data("target")}}),$("#invoiceSelect1").html(invoiceWordmethod(invoiceWord.parent)),$("#invoiceSelect2").html(invoiceWordmethod(invoiceWord.parent[0].child))});var invoiceSelect1=$("#invoiceSelect1").selectUI({width:160,height:40,addClass:"fl",after:function(e){var i="",t=$(e).attr("value");"0"==t?i+=invoiceWordmethod(invoiceWord.parent[0].child):"1"==t?i+=invoiceWordmethod(invoiceWord.parent[1].child):"2"==t&&(i+=invoiceWordmethod(invoiceWord.parent[2].child)),$("#invoiceSelect2").html(i),invoiceSelect2.render()}}),invoiceSelect2=$("#invoiceSelect2").selectUI({width:160,height:40,addClass:"fl ml10"}),province=$("#province").selectUI({width:160,height:40,addClass:"fl",after:function(e){var i=(e.attr("value"),e.attr("data-id")),t=$("#citys"),n=cityText;if(void 0!=i)for(var o=0,a=city[i].length;o<a;o++)n+="<option value='"+city[i][o].name+"'>"+city[i][o].name+"</option>";return t.html(n),citys.render(),!0}}),citys=$("#citys").selectUI({width:160,height:40,addClass:"fl ml10"});