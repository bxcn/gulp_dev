/**  * kuaihuojian project - kuaihuojian project  */ "use strict";function PersonalInfo(){function t(){v&&(e=$(g),a=e.find(".personal_info").get(0),n=e.find(".photo").get(0),i=e.find(".star").get(0),l=e.find(".name").get(0),s=e.find(".age").get(0),d=e.find(".tel_icon").get(0),o=e.find(".sms_icon").get(0),r=e.find(".email_icon").get(0),c=e.find(".job").get(0),u=e.find(".instrude").get(0),p=e.find(".city").get(0),h=e.find(".msg_status").get(0),h.onclick=function(){f("ViewRecored").showData(m.userinfo.id)},DOM.appendChild("customerDialogId",e.get(0)),v=!1)}var e,a,n,i,l,s,d,o,r,c,u,p,h,m={},g="";g+='<div class="personal_info">',g+='\t\t<div class="photo photo_girl"></div>',g+='\t\t<div class="people">',g+='\t\t  <div class="star starstroke"></div>',g+='\t\t  <div class="name"></div>',g+='\t\t  <div class="age"></div>',g+="\t\t</div>",g+='\t\t<div class="msg_status">',g+='\t\t  <span class="tel_icon"></span>',g+='\t\t  <span class="sms_icon"></span>',g+='\t\t  <span class="email_icon"></span>',g+="\t\t</div>",g+='\t\t<div class="profession">',g+='\t\t  <span class="job"></span>',g+='\t\t  <span class="instrude"></span>',g+='\t\t  <span class="city"></span>',g+="\t\t</div>",g+="</div>";var v=!0;this.setStar=function(t){t?i.style.visibility="visible":i.style.visibility="hidden"},this.setMsgStatus=function(t){t?(DOM.show(h),this.setOperaRecord(m.userinfo.id)):DOM.hide(h)},this.setPhoto=function(){"先生"==m.userinfo.gender?n.setAttribute("class","photo_boy"):n.setAttribute("class","photo_girl")},this.setLinkman=function(){m.userinfo.is_fav?i.setAttribute("class","starfill favoriteId"+m.userinfo.id):i.setAttribute("class","starstroke favoriteId"+m.userinfo.id),i.onclick=function(){favoriteAction(i,m.userinfo.id)},l.innerHTML=m.userinfo.name,s.innerHTML=m.userinfo.gender+"<em>|</em>"+m.userinfo.age+"岁"},this.setProfessional=function(){c.innerHTML="职位："+m.userinfo.job,c.title="职位："+m.userinfo.jobCnt,u.innerHTML="行业："+m.userinfo.trade,u.title="行业："+m.userinfo.tradeCnt,p.innerHTML="城市："+m.userinfo.cur_city},this.setOperaRecord=function(t){ajaxData.post({url:"/Record/getCustomerRecordCount",data:{id:t},success:function(t){t.state?(d.innerHTML=t.data.call||0,o.innerHTML=t.data.sms||0,r.innerHTML=t.data.email||0):(d.innerHTML=0,o.innerHTML=0,r.innerHTML=0)}})},this.setPersonal=function(e){t(),m=e,this.show(),this.setPhoto(),this.setLinkman(),this.setProfessional()},this.show=function(){DOM.show(a)},this.hide=function(){DOM.hide(a)}}function CallPhone(){function t(){c&&(DOM.appendChild("customerDialogId",a),c=!1)}var e=this,a=DOM.createElement("div","call_phone"),n=DOM.createElement("div","call_info"),i=DOM.createElement("div","call_price","5元/3分钟，3分钟后每分钟2元"),l=DOM.createElement("div","call_tousu_btn","号码不正确？"),s=$("#order_id").html()||"";l.onclick=function(){"号码不正确？"==l.innerHTML&&f("TouSu").openTouSu(u.userinfo.id)};var d=DOM.createElement("div","cancel_btn","取消");d.onclick=function(){e.hide()};var o=DOM.createElement("div","ok_btn","确定");o.onclick=function(){clockSubmit.init(2e3)||ajaxData.post({url:"/ivrbase/getNumber",data:{resume_id:u.userinfo.id,order_id:s},success:function(t){if(t.state){var a=t.data;f("CallStatus").getPhone(u.userinfo.id,u.userinfo.mobilephone,a[0]+"<em>转</em>"+a[1],a[2]),e.hide()}else alert(t.msg)}})};var r=btnBar.instance();r.appendChild(d),r.appendChild(o),a.appendChild(n),a.appendChild(i),a.appendChild(l),a.appendChild(r);var c=!0,u={};this.setLinkMan=function(e){t(),u=e,n.innerHTML="是否需要通过转接号码联系"+u.userinfo.name,u.isComplaint?l.innerHTML="号码不正确？":l.innerHTML="",this.show()},this.show=function(){DOM.show(a)},this.hide=function(){DOM.hide(a)}}function CallStatus(){function t(){g&&(DOM.appendChild("customerDialogId",d),g=!1)}function e(a,n){t(),i=a;ajaxData.post({url:"/ivrbase/getCalleeStatus",data:{callee:n},success:function(t){t.state?(clearTimeout(v),s.listenCallStatus(t.recordid,a)):"expire"==t.status?(clearTimeout(v),ajaxData.post({url:"/ivrbase/getNumber",data:{resume_id:a},success:function(t){if(t.state){var e=t.data;f("CallStatus").getPhone(a,l,e[0]+"<em>转</em>"+e[1],e[2])}else alert(t.msg)}})):v=window.setTimeout(function(){e(a,n)},500)}})}function a(e,a){t();ajaxData.post({url:"/ivrbase/listenCallStatus",data:{recordid:e},success:function(t){t.state&&("incall"==t.data.status?(s.calling(),n["calling"+a]=[e,a]):"calling"==t.data.status?s.linking():(clearTimeout(M),s.called(t.data.duration_str,t.data.fee),n["calling"+a]=[]))}})}var n={},i=0,l=0,s=this,d=DOM.createElement("div","call_phone"),o=DOM.createElement("div","call_mobile"),r=DOM.createElement("div","call_number"),c=DOM.createElement("div","call_note"),u=DOM.createElement("div","cancel_btn","取消");u.onclick=function(){s.hide(),s.closeCall()};var p=DOM.createElement("div","ok_btn","重新获取号码");p.style.display="none",p.onclick=function(){ajaxData.post({url:"/ivrbase/getNumber",data:{resume_id:i},success:function(t){if(t.state){var e=t.data;f("CallStatus").getPhone(i,l,e[0]+"<em>转</em>"+e[1],e[2])}else alert(t.msg)}})};var h=btnBar.instance();h.appendChild(u),h.appendChild(p);var m=DOM.createElement("div","call_tousu_btn","号码不正确？");m.onclick=function(){"号码不正确？"==m.innerHTML&&f("TouSu").openTouSu(i)},d.appendChild(o),d.appendChild(r),d.appendChild(c),d.appendChild(h),d.appendChild(m);var g=!0;this.show=function(){DOM.show(d)},this.hide=function(){DOM.hide(d)};var v=null,M=null;this.closeCall=function(){clearTimeout(v),clearTimeout(M),v=null,M=null};var s=this;this.listenCallStatus=function(e,n){t(),a(e,n),clearTimeout(M),M=window.setInterval(function(){a(e,n)},500)},this.getCallingStatus=function(){return n};var D,C;this.getPhone=function(a,n,i,s){return t(),m.style.display="none",l=n,e(a,s),u.style.display="inline-block",p.style.display="none",this.show(),D=n,C=i,d.setAttribute("class","call_phone getTelNumber"),o.innerHTML="手机："+D+" 通过拨打以下号码为您转接",r.innerHTML=C,c.innerHTML="此号码30分钟内有效",f("CallPhone").hide(),d},this.telOut=function(e){return t(),m.style.display="none",D=e||D,this.show(),u.style.display="none",p.style.display="inline-block",d.setAttribute("class","call_phone getLinking"),o.innerHTML="手机："+D+" 通过拨打以下号码为您转接",r.innerHTML=C,c.innerHTML="此电话号码已失效",d},this.linking=function(e){return t(),m.style.display="none",D=e||D,this.show(),u.style.display="inline-block",p.style.display="none",d.setAttribute("class","call_phone getLinking"),o.innerHTML="手机："+D+" 通过拨打以下号码为您转接",r.innerHTML=C,c.innerHTML="正在呼叫对方......",d},this.calling=function(e){return t(),m.style.display="none",D=e||D,this.show(),u.style.display="inline-block",p.style.display="none",d.setAttribute("class","call_phone getCalling"),o.innerHTML="手机："+D+" 通过拨打以下号码为您转接",r.innerHTML=C,c.innerHTML="正在通话中......",d},this.called=function(e,a){return t(),m.style.display="block",this.show(),u.style.display="inline-block",p.style.display="none",d.setAttribute("class","call_phone getTeled"),o.innerHTML="手机："+D+" 通过拨打以下号码为您转接",r.innerHTML=C,c.innerHTML="通话已结束  本次通话"+e+" 收费"+a+"元",d}}function Colligation(){function t(){S&&(DOM.appendChild("customerDialogId",a),DOM.appendChild("customerDialogId",M),S=!1,D=$("#selectSMS").selectUI({width:343,height:30,addClass:"fl mt15 select",init:function(t){t=$(t);var e=t.attr("data-id"),a=t.attr("data-create"),n=t.attr("data-name"),i=t.attr("data-size"),l=$("<em class='hand' onclick='alertMsg(this,"+e+")'>预览</em>");a?(t.append("<a class='txtline blue ml20' target='_blank' href='/Template/msgTpl'>"+a+"</a>"),t.attr("isCreate",!0)):(t.append("<strong>"+n+"</strong>"),t.append("<span>"+i+"</span>"),t.append(l))},before:function(t){return"true"!=$(t).attr("isCreate")}}),C=$("#selectEmail").selectUI({width:343,height:30,addClass:"fl mt15 select",init:function(t){t=$(t);var e=t.attr("data-id"),a=t.attr("data-create"),n=t.attr("data-name"),i=t.attr("data-size"),l=$("<em class='hand' onclick='alertMail(this,"+e+")'>预览</em>");a?(t.append("<a class='txtline blue ml20 '  target='_blank'  href='/Template/emailTpl'>"+a+"</a>"),t.attr("isCreate",!0)):(t.append("<strong>"+n+"</strong>"),t.append("<span>"+i+"</span>"),t.append(l))},before:function(t){return"true"!=$(t).attr("isCreate")}}))}var e=0,a=DOM.createElement("div","colligation"),n=DOM.createElement("div","item"),i=DOM.createElement("div","icon sms"),l=DOM.createElement("select");l.id="selectSMS";var s=DOM.createElement("div","send_btn","发短信(0/5)");s.onclick=function(){var t=s.getAttribute("data-ready");if("true"!=t){var a=$("#selectSMS").find("option:selected").val(),n=[b.userinfo.id];ajaxData.post({url:"/SellerSms/commitOrder",data:{receiver_ids:n,tpl_id:a},success:function(t){var e="";if(e+='<table class="mt10">',e+="    <tr>",e+='      <td width="20%">目标客户ID</td>',e+='      <td width="30%">目标客户</td>',e+='      <td width="30%">无法推送原因</td>',e+="    </tr>",t.state){var a=t.data;$("#massSendSMSDialog").find(".tsrs").text(a.cansend),$("#massSendSMSDialog").find(".dxts").text(a.msg_count),$("#massSendSMSDialog").find(".zqs").text(a.total_money),$("#massSendSMSDialog").find(".total_count").text(a.total_count),$("#massSendSMSDialog").find(".cannotsend").text(a.cannotsend);var n=t.data.list;if(n.length){for(var i=0,l=n.length;i<l;i++)e+="    <tr>",e+="      <td>"+n[i].rocket_id+"</td>",e+='      <td><em class="mr5">'+n[i].name+"</em>"+n[i].age+"</td>",e+="      <td>"+n[i].reason+"</td>",e+="    </tr>";e+="  </table>",$("#sendSMSState").html(e).parent().show()}else $("#sendSMSState").parent().hide();0==t.data.cansend&&(sureSendSMS=function(){alert("暂无有效推送人数")})}}}),massSendSMSDialog.dialog("open"),sureSendSMS=function(){clockSubmit.init()||ajaxData.post({url:"/SellerSms/sms_send",data:{receiver_ids:n,tpl_id:a},success:function(t){if(t.state){alert("发送成功"),massSendSMSDialog.dialog("close");var a=+$(".callTimes").eq(0).text(),n=+$(".emailTimes").eq(0).text(),i=+$(".msgTimes").eq(0).text();$(".msgTimes").text(i+1),$(".operationNumber").text(a+i+n),e+=1,s.innerHTML="发短信("+e+"/5)",e>4&&(s.setAttribute("class","send_btn_disabled"),s.setAttribute("data-ready",!0))}else alert(t.msg||"发送失败")}})}}},n.appendChild(i),n.appendChild(l),n.appendChild(s);var d=DOM.createElement("div","item"),o=DOM.createElement("div","icon email"),r=DOM.createElement("select");r.id="selectEmail";var c=DOM.createElement("div","send_btn","发邮件");c.onclick=function(){var t=c.getAttribute("data-ready");if("true"!=t){var e=[b.userinfo.id],a=$("#selectEmail").find("option:selected").val();ajaxData.post({url:"/SellerEmailSend/isFundEnough",data:{receiver_ids:e,tpl_id:a},success:function(t){t.state?($('[data-trigger="chongzhi"]').hide(),$('[data-trigger="tishi"]').show()):($('[data-trigger="chongzhi"]').show(),$('[data-trigger="tishi"]').hide())}}),$("#massSendEmailDialog").find(".tsrs").text(e.length),$("#massSendEmailDialog").find(".zqs").text(parseFloat(.1*e.length).toFixed(1)),massSendEmailDialog.dialog("open"),sureSendEmail=function(){clockSubmit.init()||ajaxData.post({url:"/SellerEmailSend/email_send",data:{receiver_ids:e,tpl_id:a},success:function(t){if(t.state){alert("发送成功"),massSendEmailDialog.dialog("close");var e=+$(".callTimes").eq(0).text(),a=+$(".emailTimes").eq(0).text(),n=+$(".msgTimes").eq(0).text();$(".emailTimes").text(a+1),$(".operationNumber").text(e+n+a)}else alert(t.msg||"发送失败")}})}}},d.appendChild(o),d.appendChild(r),d.appendChild(c);var u=DOM.createElement("div","item add_note"),p=DOM.createElement("div","icon","备注："),h=DOM.createElement("input");h.setAttribute("maxlength",30),h.type="text";var m=DOM.createElement("div","clearInput","&#xe605;");m.onclick=function(){h.value="",m.style.display="none"},h.onfocus=function(){m.style.display="block"};var g=DOM.createElement("div","send_btn","保存");g.onclick=function(){if(!clockSubmit.init()){var t=h.value,e=b.userinfo.id;return t.length>30?void alert("备注少于30字！"):void ajaxData.post({url:"/CustomerRemark/add/",data:{cust_id:e,content:t},success:function(t){t.state?(alert("备注保存成功"),window.setTimeout(function(){m.style.display="none"},2e3)):alert(t.msg)}})}},u.appendChild(p),u.appendChild(h),u.appendChild(m),u.appendChild(g);var v=DOM.createElement("div","ok_btn","给他打电话");v.onclick=function(){if(!clockSubmit.init(500)){var t=f("CallStatus").getCallingStatus()["calling"+b.userinfo.id];t&&2==t.length?(f("CallStatus").listenCallStatus(t[0],t[1]),f("CallPhone").hide(),f("CallStatus").show()):(f("CallPhone").setLinkMan(b),f("CallStatus").hide())}};var M=btnBar.instance();M.appendChild(v),a.appendChild(n),a.appendChild(d),a.appendChild(u);var D,C,b={},S=!0,b={};this.setColligation=function(e){t(),b=e,this.show(),this.setSMS(),this.setEmail(),this.getNote(),this.showCallBtn(!0)},this.showCallBtn=function(t){t?DOM.show(M):DOM.hide(M)},this.setSMS=function(){e=0,i.innerHTML="手机："+b.userinfo.mobilephone,l.innerHTML="",ajaxData.post({url:"/Template/getMsgTplList",data:{customer_id:b.userinfo.id},success:function(t){if(t.state){for(var a=t.data,n=0,i=a.length;n<i;n++){var a=t.data[n],d=document.createElement("option");d.setAttribute("data-name",a.title),d.setAttribute("data-size",a.length+"字/"+Math.ceil(a.length/67)+"条"),d.setAttribute("data-id",a.id),d.setAttribute("value",a.id),l.appendChild(d),e+=parseInt(a.todayTimes||0)}s.innerHTML="发短信("+e+"/5)",s.setAttribute("class","send_btn"),s.setAttribute("data-ready",!1),e>5&&(s.setAttribute("class","send_btn_disabled"),s.setAttribute("data-ready",!0),s.innerHTML="今日发送超限"),0==i&&(s.setAttribute("class","send_btn_disabled"),s.setAttribute("data-ready",!0),s.innerHTML="发短信("+e+"/5)")}var o=document.createElement("option");o.setAttribute("data-create","新建短信模板"),l.appendChild(o),D.render()}})},this.setEmail=function(){o.innerHTML="邮件："+b.userinfo.email,r.innerHTML="",ajaxData.post({url:"/Template/getEmailTplList",data:{customer_id:b.userinfo.id},success:function(t){if(t.state)for(var e=0,a=t.data.length;e<a;e++){var n=t.data[e],i=document.createElement("option");i.setAttribute("data-name",n.title),i.setAttribute("data-size",Math.ceil(n.length/1024)+"K"),i.setAttribute("data-id",n.id),i.setAttribute("value",n.id),r.appendChild(i)}var l=document.createElement("option");l.setAttribute("data-create","新建邮件模板"),r.appendChild(l),C.render(),c.setAttribute("class","send_btn"),c.setAttribute("data-ready",!1),0==a&&(c.setAttribute("class","send_btn_disabled"),c.setAttribute("data-ready",!0))}})},this.getNote=function(){var t=b.userinfo.id;ajaxData.post({url:"/CustomerRemark/jsonList",data:{cust_id:t},success:function(t){t.state&&t.data.length>0?h.value=t.data[0]&&t.data[0].content||"":h.value=""}})},this.show=function(){DOM.show(a)},this.hide=function(){DOM.hide(a)}}function ViewRecored(){function t(){s&&(DOM.appendChild("customerDialogId",a),s=!1)}var e=this,a=DOM.createElement("div","opera_record"),n=DOM.createElement("div","opera_record_table"),i=DOM.createElement("div","cancel_btn","取消");i.onclick=function(){e.hide()};var l=btnBar.instance();l.appendChild(i),a.appendChild(n),a.appendChild(l);var s=!0;this.showData=function(e){var i=this;if(t(),"block"==a.style.display)return void i.hide();var l="";l+="<table>",l+="\t<thead>",l+='\t\t<tr class="list-title">',l+='\t\t\t<td width="10%">操作方式</td>',l+='\t\t\t<td width="80%">操作记录</td>',l+='\t\t\t<td width="10%">消费</td>',l+="\t\t</tr>",l+="\t</thead>",l+="\t<tbody>",l+="\ttemplate",l+="\t</tbody>",l+="</table>",ajaxData.post({url:"/Record/getCustomerRecord",data:{id:e},success:function(t){var e="";if(t.state){for(var a=t.data,s=0,d=a.length;s<d;s++){var o=a[s];"call"==o.rtype&&(e+="<tr>",e+="\t<td>电话</td>",e+="\t<td>",e+='\t\t<em class="fl ml10">'+o.starttime+" -- "+o.endtime+"（"+o.calltime+"）</em>",e+='\t\t<em class="fr mr20 blue txtline openAudio hand"  data-logid="'+o.id+'" data-voice-wav="'+o.wavrecord+'" data-voice-mp3="'+o.mp3record+'">听录音</em>',e+="\t</td>",e+="\t<td>"+o.fee+"元</td>",e+="</tr>"),"sms"==o.rtype&&(e+="<tr>",e+="\t<td>短信</td>",e+="\t<td>",e+='\t\t<span class="fl ml10"> '+o.addtime+' <em class="ml20">'+o.title+"</em></span>",e+='\t\t<span class="fr mr20 blue txtline hand" onclick="alertMsg(this,'+o.tpl_id+')">预览</span>',e+='\t\t<span class="fr mr10">'+o.length+"字/"+Math.ceil(o.length/67)+"条</span>",e+="\t</td>",e+="\t<td>"+o.fee+"元</td>",e+="</tr>",e+="<tr>"),"email"==o.rtype&&(e+="<tr>",e+="\t<td>邮件</td>",e+="\t<td>",e+='\t\t<span class="fl ml10"> '+o.addtime+' <em class="ml20">'+o.title+"</em></span>",e+='\t\t<span class="fr mr20 blue txtline hand" onclick="alertMail(this,'+o.tpl_id+')">预览</span>',e+='\t\t<span class="fr mr10">'+Math.ceil(o.length/2012)+"K</span>",e+="\t</td>",e+="\t<td>"+o.fee+"元</td>",e+="</tr>")}""==e&&(e="<tr><td colspan='3'>暂无操作记录</td></tr>")}n.innerHTML=l.replace("template",e),i.show()}})},this.show=function(){DOM.show(a)},this.hide=function(){DOM.hide(a)}}function PullRecord(){function t(){p&&(DOM.appendChild("customerDialogId",a),DOM.appendChild("customerDialogId",u),p=!1)}function e(t){t?DOM.show(u):DOM.hide(u)}var a=DOM.createElement("div","pullRecord"),n=DOM.createElement("div","smsEmail"),i=DOM.createElement("div","sms"),l=DOM.createElement("div","icon");i.appendChild(l);var s=DOM.createElement("div","email"),d=DOM.createElement("div","icon");s.appendChild(d),n.appendChild(i),n.appendChild(s);var o=DOM.createElement("h2","list_title","推送记录"),r=DOM.createElement("ul","list");a.appendChild(n),a.appendChild(o),a.appendChild(r);var c=DOM.createElement("div","ok_btn","给他打电话");c.onclick=function(){var t=f("CallStatus").getCallingStatus()["calling"+h.userinfo.id];t&&2==t.length?(f("CallStatus").listenCallStatus(t[0],t[1]),f("CallPhone").hide(),f("CallStatus").show()):(f("CallPhone").setLinkMan(h),f("CallStatus").hide())};var u=btnBar.instance();u.appendChild(c);var p=!0,h={};this.setPersonal=function(a,n){t(),h=a,l.innerHTML="手机："+h.userinfo.mobilephone,d.innerHTML="邮箱："+h.userinfo.email;var i="";i+="<li>",i+="\t<span>{time}</span>",i+='\t<a href="{linkUrl}" target="_blank">{linkName}</a>',i+='\t<div class="email">邮件：{email}</div>',i+='\t<div class="sms">短信：{phone}</div>',i+="</li>";var s='<li class="empty">客户尚未推送过 推送后可查看推送记录</li>',o="";$(n).each(function(t,e){o+=i.replace(/\{linkName}/gi,e.title).replace(/\{linkUrl}/gi,e.url).replace(/\{time}/gi,e.time).replace(/\{phone}/gi,e.phone.replace("失败","<em class='red'>失败</em>")).replace(/\{email}/gi,e.email.replace("失败","<em class='red'>失败</em>"))}),e(n.length?!0:!1),r.innerHTML=o?o:s,this.show()},this.show=function(){DOM.show(a)},this.hide=function(){DOM.hide(a)}}function TouSu(){function t(){u&&(DOM.appendChild("customerDialogId",n),u=!1)}var e=this,a=a,n=DOM.createElement("div","call_phone call_tousu"),i=DOM.createElement("label"),l=DOM.createElement("input","");l.type="radio",l.name="reason",l.value=1,l.setAttribute("checked","checked"),i.appendChild(l),i.appendChild(DOM.createElement("span","ml15","姓名、性别不对"));var s=DOM.createElement("label"),d=DOM.createElement("input","");d.type="radio",d.name="reason",d.value=2,s.appendChild(d),s.appendChild(DOM.createElement("span","ml15","手机号停机、空号")),n.appendChild(i),n.appendChild(s);var o=DOM.createElement("div","cancel_btn","取消");o.onclick=function(){e.hide()};var r=DOM.createElement("div","ok_btn","确定");r.onclick=function(){var t=$("#orderId").val()||"",e=$("input[name='reason']:checked").val();ajaxData.post({url:"/DealComplaint/index",data:"id="+a+"&order_id="+t+"&reason="+e,success:function(t){t.status?f("TouSuJieGuo").openTouSuJieGuo(t.complaint_msg):alert(t.complaint_msg)}})};var c=btnBar.instance();c.appendChild(o),c.appendChild(r),n.appendChild(c),DOM.appendChild("customerDialogId",n);var u=!0;this.openTouSu=function(e){t(),a=e,this.show()},this.show=function(){n.style.display="block"},this.hide=function(){n.style.display="none"}}function TouSuJieGuo(){function t(){l&&(DOM.appendChild("customerDialogId",e),l=!1)}var e=DOM.createElement("div","call_phone call_tousujieguo"),a=DOM.createElement("span","mt60"),n=DOM.createElement("p","f14 mt35","您于2016-5-26 22:22:11 提交投诉，1个工作日内确认投诉信息，确认后按规定进行奖励。"),i=DOM.createElement("em","f18 blue mt25","当前状态：待审核");e.appendChild(a),e.appendChild(n),e.appendChild(i);var l=!0;this.openTouSuJieGuo=function(e){t(),this.show(),n.innerHTML=e},this.show=function(){e.style.display="block"},this.hide=function(){e.style.display="none"}}function CreateCustomerDialog(){function t(){if(e){var t="";t+='<div id="customerDialog" class="hide" >',t+='  <div id="customerDialogId" class="customerDialog">',t+="  </div>",t+="</div>",$("body").append(t);var n=document.getElementById("customerDialogId");n.onselectstart=function(){return!1},a=$("#customerDialog").dialog({width:789,title:"目标客户",close:function(){f("CallStatus").closeCall()}}),e=!1}}var e=!0,a=null;this.open=function(e,n,i){t(),a.dialog("open"),e&&ajaxData.post({url:"/DialogInfo/index",data:{id:e,orderid:n},success:function(t){i.call(window,t)}})}}var console=console||{log:function(){}},DOM={};DOM.createElement=function(t,e,a){var n=document.createElement(t);return e&&n.setAttribute("class",e),void 0!=a&&(n.innerHTML=a),n},DOM.getId=function(t){return document.querySelector?document.querySelector("#"+t):document.getElementById(t)},DOM.appendChild=function(t,e){"string"==typeof t&&(t=DOM.getId(t)||DOM.createElement("span","","no found "+t+"DOM")),"string"==typeof e&&(e=DOM.getId(e)||DOM.createElement("span","","no found "+e+"DOM")),t.appendChild(e)},DOM.show=function(t){"undefined"!=typeof t&&(t.style.display="block")},DOM.hide=function(t){"undefined"!=typeof t&&(t.style.display="none")};var btnBar=function(){function t(){return DOM.createElement("div","customer_btn_bar")}var e=null;return{instance:function(){return e||(e=new t),e.cloneNode()}}}();$(document).on("click",".saleCheckCustomer",function(){var t=$(this).attr("data-id"),e=$(this).attr("data-title");f("PersonalInfo").hide(),f("Colligation").showCallBtn(!1),f("Colligation").hide(),f("ViewRecored").hide(),f("CallPhone").hide(),f("CallStatus").hide(),f("TouSu").hide(),f("TouSuJieGuo").hide(),f("CreateCustomerDialog").open(t,null,function(t){t.complaint_msg?f("TouSuJieGuo").openTouSuJieGuo(t.complaint_msg):f("TouSuJieGuo").hide(),f("PersonalInfo").setPersonal(t),f("PersonalInfo").setMsgStatus(!0),f("PersonalInfo").setStar(!0),f("Colligation").setColligation(t);var e=f("CallStatus").getCallingStatus()["calling"+t.userinfo.id];e&&2==e.length&&(f("CallStatus").listenCallStatus(e[0],e[1]),f("CallPhone").hide(),f("CallStatus").show())});var a=$("#customerDialog").prev().find(".ui-dialog-title");a.text("目标客户ID："+e)}),$(document).on("click",".checkCustomer",function(){var t=$(this).attr("data-id"),e=$(this).attr("data-title"),a=$(this).attr("orderid");f("PersonalInfo").hide(),f("PullRecord").hide(),f("CallPhone").hide(),f("CallStatus").hide(),f("TouSu").hide(),f("TouSuJieGuo").hide(),f("CreateCustomerDialog").open(t,a,function(t){f("PersonalInfo").setPersonal(t),f("PersonalInfo").setMsgStatus(!1),f("PersonalInfo").setStar(!1),f("PullRecord").setPersonal(t,t.list),t.complaint_msg?f("TouSuJieGuo").openTouSuJieGuo(t.complaint_msg):f("TouSuJieGuo").hide()});var n=$("#customerDialog").prev().find(".ui-dialog-title");n.text("目标客户ID："+e)});